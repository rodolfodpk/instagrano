<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Instagrano - Login</title>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        body { font-family: Arial; max-width: 400px; margin: 50px auto; }
        input { width: 100%; padding: 10px; margin: 10px 0; }
        button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; cursor: pointer; }
        .error { color: red; }
    </style>
</head>
<body>
    <div x-data="loginForm()">
        <h1>Instagrano Login</h1>
        <form @submit.prevent="login">
            <input x-model="email" type="email" placeholder="Email" required>
            <input x-model="password" type="password" placeholder="Password" required>
            <button type="submit">Login</button>
        </form>
        <p class="error" x-show="error" x-text="error"></p>
    </div>
    
    <script>
    function loginForm() {
        return {
            email: '',
            password: '',
            error: '',
            async login() {
                try {
                    const response = await fetch('/api/auth/login', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({email: this.email, password: this.password})
                    });
                    
                    if (response.ok) {
                        const {token} = await response.json();
                        localStorage.setItem('token', token);
                        window.location.href = '/feed.html';
                    } else {
                        this.error = 'Invalid credentials';
                    }
                } catch (e) {
                    this.error = 'Login failed';
                }
            }
        }
    }
    </script>
</body>
</html>
